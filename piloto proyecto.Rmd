
title: "An谩lisis Econ贸mico Mundial: PIB, Desempleo e Inflaci贸n"
author: "Brandon Rodr铆guez Ortiz"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    theme: cerulean
    highlight: tango
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  fig.align = 'center',
  fig.width = 8,
  fig.height = 5
)


# --- Librer铆as necesarias ---

library(ggplot2)
library(dplyr)
library(maps)
```
# --- Cargar datos ---
```{r}
data <- read.csv("base_de_datos.csv")
```
# --- Mapa base ---
```{r}
world <- map_data("world")
```
# ==========================================================
# 1锔 PIB vs TASA DE DESEMPLEO (MAPA GLOBAL)
# ==========================================================
```{r}

ggplot() +
  geom_map(data = world, map = world,
           aes(x = long, y = lat, map_id = region),
           color = "gray80", fill = "gray95", size = 0.3) +
  geom_point(data = data,
             aes(x = longitude, y = latitude,
                 size = GDP, color = Jobless.Rate),
             alpha = 0.7) +
  scale_size_continuous(range = c(2, 10)) +
  scale_color_gradient(low = "skyblue", high = "darkred") +
  labs(
    title = "PIB y Tasa de Desempleo en el Mundo",
    subtitle = "El tama帽o del punto representa el PIB (miles de millones USD)\nEl color representa la tasa de desempleo (%)",
    x = "Longitud",
    y = "Latitud",
    size = "PIB",
    color = "Tasa de desempleo"
  ) +
  theme_minimal()
```
# ==========================================================
# 2锔 RELACIN PIB vs DESEMPLEO (TENDENCIA LINEAL)
# ==========================================================
ggplot(data, aes(x = GDP, y = Jobless.Rate, color = region)) +
  geom_point(size = 3, alpha = 0.8) +
  scale_x_log10() +
  geom_smooth(method = "lm", color = "black") +
  labs(
    title = "Relaci贸n entre el PIB y la Tasa de Desempleo",
    subtitle = "Escala logar铆tmica del PIB. La l铆nea negra muestra la tendencia lineal.",
    x = "PIB (escala logar铆tmica, miles de millones USD)",
    y = "Tasa de desempleo (%)",
    color = "Regi贸n"
  ) +
  theme_minimal()

# ==========================================================
# 3锔 INFLACIN PROMEDIO POR REGIN
# ==========================================================
```{r}
inflacion_region <- data %>%
  group_by(region) %>%
  summarise(inflacion_promedio = mean(Inflation.Rate, na.rm = TRUE))

ggplot(inflacion_region, aes(x = reorder(region, inflacion_promedio), y = inflacion_promedio, fill = inflacion_promedio)) +
  geom_col() +
  coord_flip() +
  scale_fill_gradient(low = "skyblue", high = "darkred") +
  labs(
    title = "Inflaci贸n promedio por regi贸n",
    subtitle = "Comparaci贸n del nivel general de inflaci贸n en el mundo",
    x = "Regi贸n",
    y = "Inflaci贸n promedio (%)",
    fill = "Nivel de inflaci贸n"
  ) +
  theme_minimal()
```

# ==========================================================
# 4锔 MAPA MUNDIAL DE INFLACIN
# ==========================================================
```{r}
inflacion_map <- data %>% select(name, Inflation.Rate) %>% na.omit()
mapa_inflacion <- left_join(world, inflacion_map, by = c("region" = "name"))

ggplot(mapa_inflacion, aes(x = long, y = lat, group = group, fill = Inflation.Rate)) +
  geom_polygon(color = "gray70", size = 0.2) +
  scale_fill_gradientn(
    colors = c("darkblue", "skyblue", "yellow", "orange", "red", "darkred"),
    na.value = "white",
    name = "Inflaci贸n (%)"
  ) +
  labs(
    title = "Mapa mundial de inflaci贸n",
    subtitle = "El color representa la tasa de inflaci贸n promedio por pa铆s"
  ) +
  theme_minimal() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank())
```
# ==========================================================
# З CONCLUSIONES
# ==========================================================
cat("
Conclusiones Generales:
1. Existe una relaci贸n inversa entre el PIB y la tasa de desempleo.
2. Las regiones con mayor inflaci贸n muestran menor estabilidad econ贸mica.
3. frica y Am茅rica Latina presentan mayores desaf铆os en desempleo e inflaci贸n.
4. Europa y Ocean铆a mantienen econom铆as m谩s estables con baja inflaci贸n.
")












## Carga de datos y librer铆as

```{r}
# Instalar (si no tienes) y cargar librer铆as necesarias
#install.packages("ggplot2")
library(ggplot2)

# Cargar base de datos
data <- read.csv("base_de_datos.csv")

# Limpiar datos: eliminar filas con valores faltantes en las variables clave
data <- na.omit(data[, c("GDP", "Jobless.Rate", "name")])

# Crear el gr谩fico
ggplot(data, aes(x = GDP, y = Jobless.Rate, label = name)) +
  geom_point(color = "steelblue", size = 3, alpha = 0.7) +      # puntos
  geom_smooth(method = "lm", se = TRUE, color = "darkred") +    # l铆nea de tendencia
  geom_text(vjust = -1, size = 3, check_overlap = TRUE) +       # nombres de pa铆ses
  labs(
    title = "Relaci贸n entre el PIB y la tasa de desempleo",
    subtitle = "Evaluaci贸n de c贸mo el crecimiento econ贸mico influye en el empleo",
    x = "PIB (miles de millones USD)",
    y = "Tasa de desempleo (%)"
  ) +
  theme_minimal()

```

```{r, echo=FALSE}
# Instalar (si no tienes) y cargar librer铆as necesarias
#install.packages("ggplot2")
library(ggplot2)

# Cargar base de datos
data <- read.csv("base_de_datos.csv")

# Limpiar datos: eliminar filas con valores faltantes en las variables clave
data <- na.omit(data[, c("GDP", "Jobless.Rate", "name")])

# Crear el gr谩fico
ggplot(data, aes(x = GDP, y = Jobless.Rate, label = name)) +
  geom_point(color = "steelblue", size = 3, alpha = 0.7) +      # puntos
  geom_smooth(method = "lm", se = TRUE, color = "darkred") +    # l铆nea de tendencia
  geom_text(vjust = -1, size = 3, check_overlap = TRUE) +       # nombres de pa铆ses
  labs(
    title = "Relaci贸n entre el PIB y la tasa de desempleo",
    subtitle = "Evaluaci贸n de c贸mo el crecimiento econ贸mico influye en el empleo",
    x = "PIB (miles de millones USD)",
    y = "Tasa de desempleo (%)"
  ) +
  theme_minimal()

```

```{r, echo=FALSE}
library(ggplot2)

# Cargar base de datos
data <- read.csv("base_de_datos.csv")

# Limpiar datos (eliminar valores faltantes)
data <- na.omit(data[, c("latitude", "longitude", "GDP", "Jobless.Rate", "name")])

# Crear gr谩fico tipo mapa de burbujas
ggplot(data, aes(x = longitude, y = latitude)) +
  geom_point(aes(size = GDP, color = Jobless.Rate), alpha = 0.7) +
  scale_size_continuous(range = c(2, 12)) +
  scale_color_gradient(low = "skyblue", high = "darkred") +
  labs(
    title = "PIB y tasa de desempleo en el mundo",
    subtitle = "El tama帽o representa el PIB y el color la tasa de desempleo",
    x = "Longitud",
    y = "Latitud",
    size = "PIB (miles de millones USD)",
    color = "Tasa de desempleo (%)"
  ) +
  theme_minimal()


```

```{r, echo=FALSE}
ggplot(data, aes(x = GDP, y = Jobless.Rate, label = name)) +
  geom_point(color = "steelblue", size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, color = "darkred") +
  geom_text(vjust = -1, size = 3, check_overlap = TRUE) +
  scale_x_log10() +  # Escala logar铆tmica
  labs(
    title = "Relaci贸n entre el PIB (escala logar铆tmica) y la tasa de desempleo",
    subtitle = "La transformaci贸n logar铆tmica permite comparar mejor econom铆as grandes y peque帽as",
    x = "PIB (log10 de miles de millones USD)",
    y = "Tasa de desempleo (%)"
  ) +
  theme_minimal()


```

```{r, echo=FALSE}

# Instalar librer铆as si no las tienes
#install.packages(c("ggplot2", "maps"))

# Cargar librer铆as
library(ggplot2)
library(maps)

# Cargar base de datos
data <- read.csv("base_de_datos.csv")

# Limpiar datos (solo las columnas necesarias y eliminar NAs)
data <- na.omit(data[, c("latitude", "longitude", "GDP", "Jobless.Rate", "name")])

# Cargar datos del mapa mundial
world <- map_data("world")

# Crear el mapa
ggplot() +
  geom_map(data = world, map = world,
           aes(x = long, y = lat, map_id = region),
           color = "gray80", fill = "gray95", size = 0.3) +
  geom_point(data = data,
             aes(x = longitude, y = latitude,
                 size = GDP, color = Jobless.Rate),
             alpha = 0.7) +
  scale_size_continuous(range = c(2, 10)) +
  scale_color_gradient(low = "skyblue", high = "darkred") +
  labs(
    title = "PIB y Tasa de Desempleo en el Mundo",
    subtitle = "El tama帽o del punto representa el PIB (miles de millones USD)\nEl color representa la tasa de desempleo (%)",
    x = "Longitud",
    y = "Latitud",
    size = "PIB",
    color = "Tasa de desempleo"
  ) +
  theme_minimal() +
  theme(
    panel.background = element_rect(fill = "aliceblue"),
    panel.grid = element_blank(),
    plot.title = element_text(face = "bold", size = 14),
    plot.subtitle = element_text(size = 11)
  )

```
```{r, echo=FALSE}
library(viridis)

ggplot() +
  geom_map(data = world, map = world,
           aes(x = long, y = lat, map_id = region),
           color = "gray80", fill = "gray95", size = 0.3) +
  geom_point(data = data,
             aes(x = longitude, y = latitude,
                 size = GDP, color = Jobless.Rate),
             alpha = 0.8) +
  scale_size_continuous(range = c(2, 10)) +
  scale_color_viridis(option = "C", direction = -1) +
  labs(
    title = "PIB y Tasa de Desempleo en el Mundo",
    subtitle = "Escala de color viridis para mejor contraste y legibilidad",
    x = "Longitud",
    y = "Latitud",
    size = "PIB (miles de millones USD)",
    color = "Tasa de desempleo (%)"
  ) +
  theme_minimal() +
  theme(
    panel.background = element_rect(fill = "aliceblue"),
    panel.grid = element_blank(),
    plot.title = element_text(face = "bold", size = 14),
    plot.subtitle = element_text(size = 11)
  )

```

```{r, echo=FALSE}

library(ggplot2)

data <- read.csv("base_de_datos.csv")
data <- na.omit(data[, c("GDP", "Jobless.Rate", "name", "region")])

ggplot(data, aes(x = GDP, y = Jobless.Rate, color = region)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, color = "black") +
  scale_x_log10() +
  labs(
    title = "Relaci贸n entre el PIB y la Tasa de Desempleo",
    subtitle = "Escala logar铆tmica del PIB. La l铆nea negra muestra la tendencia lineal.",
    x = "PIB (escala logar铆tmica, miles de millones USD)",
    y = "Tasa de desempleo (%)",
    color = "Regi贸n"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    plot.subtitle = element_text(size = 11)
  )
```

```{r, echo=FALSE}

library(ggplot2)
data <- read.csv("base_de_datos.csv")
library(dplyr)
library(ggplot2)

# Crear el objeto inflacion
inflacion <- data %>%
  select(name, region, Inflation.Rate) %>%  # cambia el nombre si es distinto
  na.omit()

# Boxplot por regi贸n
ggplot(inflacion, aes(x = region, y = Inflation.Rate, fill = region)) +
  geom_boxplot(alpha = 0.7, outlier.color = "red") +
  labs(
    title = "Variabilidad de la Inflaci贸n entre Regiones",
    subtitle = "Comparaci贸n del nivel y dispersi贸n de la inflaci贸n por regi贸n",
    x = "Regi贸n",
    y = "Tasa de inflaci贸n (%)",
    fill = "Regi贸n"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.text.x = element_text(angle = 30, hjust = 1)
  )

```

```{r}

# Volver a cargar la base completa
data <- read.csv("base_de_datos.csv")

# Instalar librer铆as si hace falta
# install.packages(c("ggplot2", "dplyr"))

library(ggplot2)
library(dplyr)

# Seleccionar las columnas necesarias
inflacion <- data %>%
  select(name, region, Inflation.Rate) %>%
  na.omit()

# ======================
# 1锔 Boxplot por regi贸n
# ======================
ggplot(inflacion, aes(x = region, y = Inflation.Rate, fill = region)) +
  geom_boxplot(alpha = 0.7, outlier.color = "red") +
  labs(
    title = "Variabilidad de la inflaci贸n entre regiones",
    subtitle = "El boxplot muestra la dispersi贸n y los valores at铆picos",
    x = "Regi贸n",
    y = "Tasa de inflaci贸n (%)",
    fill = "Regi贸n"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.text.x = element_text(angle = 30, hjust = 1)
  )

# ======================
# 2锔 Gr谩fico de barras (promedio por regi贸n)
# ======================
inflacion_promedio <- inflacion %>%
  group_by(region) %>%
  summarise(Inflacion_Promedio = mean(Inflation.Rate, na.rm = TRUE)) %>%
  arrange(desc(Inflacion_Promedio))

ggplot(inflacion_promedio, aes(x = reorder(region, -Inflacion_Promedio),
                               y = Inflacion_Promedio, fill = region)) +
  geom_bar(stat = "identity", alpha = 0.8) +
  geom_text(aes(label = round(Inflacion_Promedio, 2)), vjust = -0.5, size = 3.5) +
  labs(
    title = "Inflaci贸n promedio por regi贸n",
    subtitle = "Comparaci贸n del nivel promedio de inflaci贸n entre regiones",
    x = "Regi贸n",
    y = "Inflaci贸n promedio (%)",
    fill = "Regi贸n"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.text.x = element_text(angle = 30, hjust = 1)
  )


```


```{r}
# Instalar y cargar librer铆as necesarias
# install.packages(c("ggplot2", "dplyr", "maps"))

library(ggplot2)
library(dplyr)
library(maps)

# Cargar los datos
data <- read.csv("base_de_datos.csv")

# Limpiar datos: solo pa铆ses con informaci贸n de inflaci贸n
inflacion_map <- data %>%
  select(name, Inflation.Rate) %>%
  na.omit()

# Datos del mapa mundial
world <- map_data("world")

# Unir la base de inflaci贸n con el mapa (por nombre del pa铆s)
mapa_inflacion <- left_join(world, inflacion_map, by = c("region" = "name"))

# Crear el mapa
ggplot(mapa_inflacion, aes(x = long, y = lat, group = group, fill = Inflation.Rate)) +
  geom_polygon(color = "gray70", size = 0.2) +
  scale_fill_gradientn(
    colors = c("darkblue", "skyblue", "yellow", "orange", "red", "darkred"),
    na.value = "white",
    name = "Inflaci贸n (%)"
  ) +
  labs(
    title = "Mapa mundial de inflaci贸n",
    subtitle = "El color representa la tasa de inflaci贸n promedio por pa铆s",
    x = "",
    y = ""
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 15),
    plot.subtitle = element_text(size = 11),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.grid = element_blank()
  )

```

```{r}
ggplot(data, aes(x = reorder(name, Inflation.Rate),
                 y = Inflation.Rate,
                 fill = region)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Inflaci贸n por pa铆s y regi贸n",
    subtitle = "Comparaci贸n de la inflaci贸n individual por pa铆s",
    x = "Pa铆s",
    y = "Tasa de inflaci贸n (%)",
    fill = "Regi贸n"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 15),
    axis.text.y = element_text(size = 7)
  )
```

```{r}
library(dplyr)
library(ggplot2)

# Calcular inflaci贸n promedio por regi贸n
inflacion_promedio <- data %>%
  group_by(region) %>%
  summarise(Inflacion_Promedio = mean(Inflation.Rate, na.rm = TRUE)) %>%
  arrange(desc(Inflacion_Promedio))

# Gr谩fico de barras con escala de color (azul = baja, rojo = alta inflaci贸n)
ggplot(inflacion_promedio, aes(x = reorder(region, Inflacion_Promedio),
                               y = Inflacion_Promedio,
                               fill = Inflacion_Promedio)) +
  geom_col(alpha = 0.9) +
  coord_flip() +
  scale_fill_gradient(low = "skyblue", high = "darkred") +
  geom_text(aes(label = round(Inflacion_Promedio, 2)), hjust = -0.2, size = 3.8) +
  labs(
    title = "Inflaci贸n promedio por regi贸n",
    subtitle = "Comparaci贸n del nivel general de inflaci贸n en el mundo",
    x = "Regi贸n",
    y = "Inflaci贸n promedio (%)",
    fill = "Nivel de inflaci贸n"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 15),
    axis.text.y = element_text(size = 11),
    panel.grid.minor = element_blank()
  )
```